<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=50710&amp;path=livereload" data-no-instant defer></script>
  <title>
  Mastering Bulk RNA-seq Analysis â€“ Post 5: Normalization Methods Â· Badran Elshenawy
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Badran Elshenawy">
<meta name="description" content="Master the critical step of RNA-seq normalization with DESeq2. Learn why raw counts mislead, how the median-of-ratios method works, and why proper normalization is essential for reliable biological discoveries.">
<meta name="keywords" content="[bioinformatics data science linux command-line HPC automation]">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Mastering Bulk RNA-seq Analysis â€“ Post 5: Normalization Methods">
  <meta name="twitter:description" content="Master the critical step of RNA-seq normalization with DESeq2. Learn why raw counts mislead, how the median-of-ratios method works, and why proper normalization is essential for reliable biological discoveries.">

<meta property="og:url" content="http://localhost:50710/posts/normalization-methods/">
  <meta property="og:site_name" content="Badran Elshenawy">
  <meta property="og:title" content="Mastering Bulk RNA-seq Analysis â€“ Post 5: Normalization Methods">
  <meta property="og:description" content="Master the critical step of RNA-seq normalization with DESeq2. Learn why raw counts mislead, how the median-of-ratios method works, and why proper normalization is essential for reliable biological discoveries.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-13T08:00:00+00:00">
    <meta property="article:modified_time" content="2025-08-13T08:00:00+00:00">
    <meta property="article:tag" content="DESeq2">
    <meta property="article:tag" content="RNA-Seq">
    <meta property="article:tag" content="Normalization">
    <meta property="article:tag" content="Size Factors">
    <meta property="article:tag" content="Median of Ratios">
    <meta property="article:tag" content="Library Size">




<link rel="canonical" href="http://localhost:50710/posts/normalization-methods/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:50710/">
      Badran Elshenawy
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:50710/posts/normalization-methods/">
              Mastering Bulk RNA-seq Analysis â€“ Post 5: Normalization Methods
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2025-08-13T08:00:00Z">
                August 13, 2025
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              8-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/bioinformatics/">Bioinformatics</a>
      <span class="separator">â€¢</span>
    <a href="/categories/r/">R</a>
      <span class="separator">â€¢</span>
    <a href="/categories/rna-seq/">RNA-Seq</a>
      <span class="separator">â€¢</span>
    <a href="/categories/data-normalization/">Data Normalization</a>
      <span class="separator">â€¢</span>
    <a href="/categories/statistics/">Statistics</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/deseq2/">DESeq2</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/rna-seq/">RNA-Seq</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/normalization/">Normalization</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/size-factors/">Size Factors</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/median-of-ratios/">Median of Ratios</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/library-size/">Library Size</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/composition-bias/">Composition Bias</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/tmm/">TMM</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/tpm/">TPM</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/gene-expression-analysis/">Gene Expression Analysis</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <h1 id="-mastering-bulk-rna-seq-analysis-in-r----post-5-normalization-methods">
  ðŸ§¬ Mastering Bulk RNA-seq Analysis in R &ndash; Post 5: Normalization Methods
  <a class="heading-link" href="#-mastering-bulk-rna-seq-analysis-in-r----post-5-normalization-methods">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<h2 id="-the-raw-count-reality-check">
  ðŸš¨ The Raw Count Reality Check
  <a class="heading-link" href="#-the-raw-count-reality-check">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Here&rsquo;s a scenario that catches many researchers off guard: You&rsquo;ve just received your RNA-seq results, and Gene X shows 1,000 counts in Sample A but only 250 counts in Sample B. Your first instinct might be to conclude that Gene X is 4-fold higher in Sample A. <strong>But you&rsquo;d be completely wrong.</strong></p>
<p>Why? Because Sample A had 20 million total reads while Sample B had only 5 million. The difference you&rsquo;re seeing isn&rsquo;t biology&mdash;it&rsquo;s just that Sample A got sequenced four times more deeply!</p>
<p>This is why normalization isn&rsquo;t optional in RNA-seq analysis. It&rsquo;s the critical step that transforms meaningless raw counts into biologically interpretable expression values. Get this wrong, and even the most sophisticated downstream analyses will give you misleading results.</p>
<hr>
<h2 id="-what-normalization-actually-solves">
  ðŸŽ¯ What Normalization Actually Solves
  <a class="heading-link" href="#-what-normalization-actually-solves">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="1-library-size-differences">
  1. Library Size Differences
  <a class="heading-link" href="#1-library-size-differences">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p><strong>The Problem</strong>: Different samples get sequenced to different depths due to technical variation in library preparation and sequencing.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Example raw sequencing depths</span>
</span></span><span class="line"><span class="cl"><span class="n">sample_depths</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">Sample1</span> <span class="o">=</span> <span class="m">25000000</span><span class="p">,</span>  <span class="c1"># 25M reads</span>
</span></span><span class="line"><span class="cl">  <span class="n">Sample2</span> <span class="o">=</span> <span class="m">15000000</span><span class="p">,</span>  <span class="c1"># 15M reads  </span>
</span></span><span class="line"><span class="cl">  <span class="n">Sample3</span> <span class="o">=</span> <span class="m">30000000</span>   <span class="c1"># 30M reads</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><p><strong>The Impact</strong>: A gene with identical expression will have wildly different raw counts across samples.</p>
<h3 id="2-composition-bias">
  2. Composition Bias
  <a class="heading-link" href="#2-composition-bias">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p><strong>The Problem</strong>: A few highly expressed genes can dominate the total read count, making other genes appear artificially low.</p>
<p><strong>Real Example</strong>: If Sample A has a viral infection causing massive upregulation of interferon genes, those genes will consume a large portion of the total reads, making housekeeping genes appear downregulated even if their actual expression hasn&rsquo;t changed.</p>
<h3 id="3-gene-length-bias-context-dependent">
  3. Gene Length Bias (Context-Dependent)
  <a class="heading-link" href="#3-gene-length-bias-context-dependent">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p><strong>The Problem</strong>: Longer genes naturally capture more reads than shorter genes with identical expression levels.</p>
<p><strong>When This Matters</strong>: Comparing expression between different genes (TPM/FPKM), but not for differential expression of the same gene across conditions (DESeq2).</p>
<hr>
<h2 id="-deseq2s-median-of-ratios-method-made-simple">
  ðŸ§  DESeq2&rsquo;s Median-of-Ratios Method Made Simple
  <a class="heading-link" href="#-deseq2s-median-of-ratios-method-made-simple">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>DESeq2 uses an elegant approach that&rsquo;s easier to understand with a concrete example:</p>
<h3 id="simple-example-3-genes-3-samples">
  Simple Example: 3 Genes, 3 Samples
  <a class="heading-link" href="#simple-example-3-genes-3-samples">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p><strong>Step 1: Your raw count data</strong></p>
<table>
  <thead>
      <tr>
          <th>Gene</th>
          <th>Sample1</th>
          <th>Sample2</th>
          <th>Sample3</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>A</td>
          <td>100</td>
          <td>200</td>
          <td>150</td>
      </tr>
      <tr>
          <td>B</td>
          <td>50</td>
          <td>100</td>
          <td>75</td>
      </tr>
      <tr>
          <td>C</td>
          <td>200</td>
          <td>400</td>
          <td>300</td>
      </tr>
  </tbody>
</table>
<p><strong>Step 2: Calculate &ldquo;typical&rdquo; expression for each gene (geometric mean)</strong></p>
<table>
  <thead>
      <tr>
          <th>Gene</th>
          <th>Typical Expression</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>A</td>
          <td>147</td>
      </tr>
      <tr>
          <td>B</td>
          <td>73</td>
      </tr>
      <tr>
          <td>C</td>
          <td>294</td>
      </tr>
  </tbody>
</table>
<p><strong>Step 3: For each sample, how do the genes compare to their typical expression?</strong></p>
<table>
  <thead>
      <tr>
          <th>Gene</th>
          <th>Sample1 Ratio</th>
          <th>Sample2 Ratio</th>
          <th>Sample3 Ratio</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>A</td>
          <td>100/147 = 0.68</td>
          <td>200/147 = 1.36</td>
          <td>150/147 = 1.02</td>
      </tr>
      <tr>
          <td>B</td>
          <td>50/73 = 0.68</td>
          <td>100/73 = 1.37</td>
          <td>75/73 = 1.03</td>
      </tr>
      <tr>
          <td>C</td>
          <td>200/294 = 0.68</td>
          <td>400/294 = 1.36</td>
          <td>300/294 = 1.02</td>
      </tr>
  </tbody>
</table>
<p><strong>Step 4: Take the median ratio for each sample (this is the size factor)</strong> - Sample1: <strong>0.68</strong> (all genes are lower than typical) - Sample2: <strong>1.36</strong> (all genes are higher than typical)</p>
<ul>
<li>Sample3: <strong>1.02</strong> (all genes are close to typical)</li>
</ul>
<p><strong>Step 5: Divide each sample&rsquo;s counts by its size factor</strong></p>
<table>
  <thead>
      <tr>
          <th>Gene</th>
          <th>Sample1</th>
          <th>Sample2</th>
          <th>Sample3</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>A</td>
          <td>147</td>
          <td>147</td>
          <td>147</td>
      </tr>
      <tr>
          <td>B</td>
          <td>74</td>
          <td>74</td>
          <td>74</td>
      </tr>
      <tr>
          <td>C</td>
          <td>294</td>
          <td>294</td>
          <td>294</td>
      </tr>
  </tbody>
</table>
<p><strong>ðŸŽ¯ The Magic</strong>: After normalization, each gene has consistent expression across samples!</p>
<h3 id="why-this-works-so-well">
  Why This Works So Well
  <a class="heading-link" href="#why-this-works-so-well">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li><strong>Uses all genes</strong>: More robust than picking a few &ldquo;housekeeping&rdquo; genes</li>
<li><strong>Median is stable</strong>: A few weird genes won&rsquo;t throw off the calculation</li>
<li><strong>Gene-specific ratios</strong>: Accounts for the fact that different genes naturally have different expression levels</li>
</ul>
<hr>
<h2 id="-different-normalization-approaches">
  ðŸ’ª Different Normalization Approaches
  <a class="heading-link" href="#-different-normalization-approaches">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="deseq2-size-factors-what-we-recommend">
  DESeq2 Size Factors (What We Recommend)
  <a class="heading-link" href="#deseq2-size-factors-what-we-recommend">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p><strong>What it does</strong>: Uses the median-of-ratios method we just explained <strong>Best for</strong>: Finding differentially expressed genes <strong>Why it&rsquo;s great</strong>: Robust and handles most real-world problems</p>
<h3 id="tmm-alternative-method">
  TMM (Alternative Method)
  <a class="heading-link" href="#tmm-alternative-method">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p><strong>What it does</strong>: Similar to DESeq2 but trims extreme values <strong>Best for</strong>: Datasets with very unusual composition bias <strong>When to use</strong>: If DESeq2 size factors look weird</p>
<h3 id="tpmfpkm-different-purpose">
  TPM/FPKM (Different Purpose)
  <a class="heading-link" href="#tpmfpkm-different-purpose">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p><strong>What it does</strong>: Also accounts for how long each gene is <strong>Best for</strong>: Comparing expression between different genes (Gene A vs Gene B) <strong>Important</strong>: Don&rsquo;t use these for differential expression analysis!</p>
<hr>
<h2 id="-normalization-in-practice">
  ðŸ”¬ Normalization in Practice
  <a class="heading-link" href="#-normalization-in-practice">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="quick-deseq2-normalization">
  Quick DESeq2 Normalization
  <a class="heading-link" href="#quick-deseq2-normalization">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># This happens automatically in DESeq()</span>
</span></span><span class="line"><span class="cl"><span class="n">dds</span> <span class="o">&lt;-</span> <span class="nf">estimateSizeFactors</span><span class="p">(</span><span class="n">dds</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># View size factors</span>
</span></span><span class="line"><span class="cl"><span class="nf">sizeFactors</span><span class="p">(</span><span class="n">dds</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Example Output</strong>:</p>
<pre><code>Sample1  Sample2  Sample3  Sample4
   1.23     0.87     1.05     0.91
</code></pre>
<h3 id="quality-check-your-normalization">
  Quality Check Your Normalization
  <a class="heading-link" href="#quality-check-your-normalization">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Check size factor distribution</span>
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="nf">sizeFactors</span><span class="p">(</span><span class="n">dds</span><span class="p">),</span> <span class="n">breaks</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&#34;Size Factor Distribution&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Size factors should typically be between 0.5 and 2</span>
</span></span><span class="line"><span class="cl"><span class="nf">range</span><span class="p">(</span><span class="nf">sizeFactors</span><span class="p">(</span><span class="n">dds</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Flag potential outliers</span>
</span></span><span class="line"><span class="cl"><span class="n">outliers</span> <span class="o">&lt;-</span> <span class="nf">sizeFactors</span><span class="p">(</span><span class="n">dds</span><span class="p">)</span> <span class="o">&lt;</span> <span class="m">0.5</span> <span class="o">|</span> <span class="nf">sizeFactors</span><span class="p">(</span><span class="n">dds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span><span class="nf">any</span><span class="p">(</span><span class="n">outliers</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">cat</span><span class="p">(</span><span class="s">&#34;Potential outlier samples:&#34;</span><span class="p">,</span> <span class="nf">names</span><span class="p">(</span><span class="nf">sizeFactors</span><span class="p">(</span><span class="n">dds</span><span class="p">))</span><span class="n">[outliers]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="before-vs-after-normalization-comparison">
  Before vs After Normalization Comparison
  <a class="heading-link" href="#before-vs-after-normalization-comparison">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Raw counts</span>
</span></span><span class="line"><span class="cl"><span class="n">raw_counts</span> <span class="o">&lt;-</span> <span class="nf">counts</span><span class="p">(</span><span class="n">dds</span><span class="p">,</span> <span class="n">normalized</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Normalized counts  </span>
</span></span><span class="line"><span class="cl"><span class="n">norm_counts</span> <span class="o">&lt;-</span> <span class="nf">counts</span><span class="p">(</span><span class="n">dds</span><span class="p">,</span> <span class="n">normalized</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Compare total counts per sample</span>
</span></span><span class="line"><span class="cl"><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">barplot</span><span class="p">(</span><span class="nf">colSums</span><span class="p">(</span><span class="n">raw_counts</span><span class="p">),</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&#34;Raw Counts&#34;</span><span class="p">,</span> <span class="n">las</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">barplot</span><span class="p">(</span><span class="nf">colSums</span><span class="p">(</span><span class="n">norm_counts</span><span class="p">),</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&#34;Normalized Counts&#34;</span><span class="p">,</span> <span class="n">las</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</span></span></code></pre></div><hr>
<h2 id="-real-example-why-normalization-changes-everything">
  ðŸ“Š Real Example: Why Normalization Changes Everything
  <a class="heading-link" href="#-real-example-why-normalization-changes-everything">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Let&rsquo;s say you&rsquo;re comparing a gene between three samples:</p>
<p><strong>Before normalization (raw counts):</strong> - Sample 1: 1,000 counts - Sample 2: 250 counts</p>
<ul>
<li>Sample 3: 750 counts</li>
</ul>
<p><strong>Your first thought</strong>: &ldquo;Wow, this gene is 4x higher in Sample 1 than Sample 2!&rdquo;</p>
<p><strong>But wait</strong>: What if Sample 1 was sequenced much more deeply? - Sample 1: 20 million total reads (size factor = 1.6) - Sample 2: 5 million total reads (size factor = 0.4) - Sample 3: 15 million total reads (size factor = 1.2)</p>
<p><strong>After normalization:</strong> - Sample 1: 1,000 Ã· 1.6 = 625 counts - Sample 2: 250 Ã· 0.4 = 625 counts - Sample 3: 750 Ã· 1.2 = 625 counts</p>
<p><strong>The revelation</strong>: The gene actually has identical expression across all samples! The 4-fold difference was just a technical artifact.</p>
<p>This is why normalization isn&rsquo;t optional&mdash;it reveals the true biology hiding underneath technical noise.</p>
<hr>
<h2 id="-how-to-check-if-your-normalization-worked">
  âš¡ How to Check If Your Normalization Worked
  <a class="heading-link" href="#-how-to-check-if-your-normalization-worked">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="what-good-size-factors-look-like">
  What Good Size Factors Look Like
  <a class="heading-link" href="#what-good-size-factors-look-like">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li><strong>Range</strong>: Usually between 0.5 and 2.0</li>
<li><strong>Distribution</strong>: Most should be close to 1.0</li>
<li><strong>Pattern</strong>: Should reflect your expectation of sequencing depth differences</li>
</ul>
<h3 id="red-flags-to-watch-for">
  Red Flags to Watch For
  <a class="heading-link" href="#red-flags-to-watch-for">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li><strong>Size factor &lt; 0.3</strong>: Sample might have failed during library prep</li>
<li><strong>Size factor &gt; 3.0</strong>: Possible contamination or technical problems</li>
<li><strong>Weird patterns</strong>: If treatment samples all have very different size factors from controls, something might be wrong</li>
</ul>
<h3 id="quick-reality-check">
  Quick Reality Check
  <a class="heading-link" href="#quick-reality-check">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>After normalization, samples should cluster by biology (treatment vs control), not by technical factors (sequencing batch). If they still cluster by technical factors, normalization might not have been enough.</p>
<hr>
<h2 id="-why-proper-normalization-transforms-your-analysis">
  ðŸŽ‰ Why Proper Normalization Transforms Your Analysis
  <a class="heading-link" href="#-why-proper-normalization-transforms-your-analysis">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="before-normalization-issues">
  Before Normalization Issues
  <a class="heading-link" href="#before-normalization-issues">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li>Samples cluster by sequencing depth, not biology</li>
<li>PCA dominated by technical variation</li>
<li>Differential expression tests find &ldquo;significant&rdquo; results that are just technical artifacts</li>
<li>Pathway analysis uses incomparable expression values</li>
</ul>
<h3 id="after-proper-normalization-benefits">
  After Proper Normalization Benefits
  <a class="heading-link" href="#after-proper-normalization-benefits">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li><strong>Biological signal emerges</strong>: Samples cluster by experimental condition</li>
<li><strong>Statistical tests work correctly</strong>: P-values reflect real biological differences</li>
<li><strong>Downstream analyses are meaningful</strong>: Clustering, PCA, and pathway analysis reveal biological patterns</li>
<li><strong>Results are reproducible</strong>: Independent experiments give consistent results</li>
</ul>
<hr>
<h2 id="-integration-with-your-analysis-workflow">
  ðŸ§¬ Integration with Your Analysis Workflow
  <a class="heading-link" href="#-integration-with-your-analysis-workflow">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Normalization happens seamlessly in the standard DESeq2 workflow:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Normalization is built into the main function</span>
</span></span><span class="line"><span class="cl"><span class="n">dds</span> <span class="o">&lt;-</span> <span class="nf">DESeq</span><span class="p">(</span><span class="n">dds</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># This single command performs:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1. Size factor estimation (normalization)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2. Dispersion estimation  </span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3. Statistical testing</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Access normalized counts for visualization</span>
</span></span><span class="line"><span class="cl"><span class="n">normalized_counts</span> <span class="o">&lt;-</span> <span class="nf">counts</span><span class="p">(</span><span class="n">dds</span><span class="p">,</span> <span class="n">normalized</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Use for downstream analysis (PCA, clustering, etc.)</span>
</span></span><span class="line"><span class="cl"><span class="n">vst_data</span> <span class="o">&lt;-</span> <span class="nf">vst</span><span class="p">(</span><span class="n">dds</span><span class="p">)</span>  <span class="c1"># Coming up in Post 6!</span>
</span></span></code></pre></div><hr>
<h2 id="-the-bottom-line-for-experimental-biologists">
  ðŸŽ¯ The Bottom Line for Experimental Biologists
  <a class="heading-link" href="#-the-bottom-line-for-experimental-biologists">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Think of normalization like this: <strong>You&rsquo;re removing the technical noise to reveal the biological signal.</strong></p>
<p><strong>Without normalization</strong>: Your results are dominated by which samples happened to get sequenced more deeply. You might think genes are differentially expressed when they&rsquo;re actually just from samples with different library sizes.</p>
<p><strong>With proper normalization</strong>: The differences you see actually reflect biology. When you validate a &ldquo;hit&rdquo; from your RNA-seq in the lab, it&rsquo;s likely to work because the difference is real, not technical.</p>
<p><strong>The practical impact</strong>: - Your differential gene lists become trustworthy - Your follow-up experiments are more likely to succeed - Your collaborators can confidence in your results - Your publications stand up to peer review</p>
<p>Remember: DESeq2 does all this normalization automatically when you run <code>DESeq(dds)</code>. You don&rsquo;t need to worry about the mathematical details&mdash;just understand that this critical step is happening behind the scenes, transforming your raw counts into biologically meaningful data.</p>
<hr>
<h2 id="-whats-next">
  ðŸ§ª What&rsquo;s Next?
  <a class="heading-link" href="#-whats-next">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p><strong>Post 6: Data Transformations (VST vs rlog)</strong> will explore how to prepare your normalized data for visualization and exploratory analysis. We&rsquo;ll discover why normalized counts still aren&rsquo;t ready for PCA and clustering, and how variance stabilizing transformations solve this final challenge.</p>
<p>Get ready to unlock the full potential of your properly normalized data! ðŸ“ˆ</p>
<hr>
<h2 id="-share-your-thoughts">
  ðŸ’¬ Share Your Thoughts!
  <a class="heading-link" href="#-share-your-thoughts">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Have you ever been surprised by how much normalization changed your results? Any tricky normalization scenarios you&rsquo;ve encountered? Drop a comment below! ðŸ‘‡</p>
<p>#RNAseq #DESeq2 #Normalization #SizeFactors #Bioinformatics #GeneExpression #BulkRNAseq #ComputationalBiology #DataAnalysis #MedianOfRatios #RStats</p>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    Â©
    
    2025
     Badran Elshenawy 
    Â·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
